test_name: Make login on server and then delete token

stages:
  - name: login
    request:
      url: http://localhost:5000/api/v1/appmgr/tokenservice
      method: POST
      auth:
        - admin
        - admin_123
    response:
      status_code: 200
      headers:
        content-type: application/json
      save:
        body:
          token: token
  - name: delete a token
    request:
      url: http://localhost:5000/api/v1/appmgr/tokenservice/{token:s}
      method: DELETE
      headers:
        x-token-id: "{token:s}"
    response:
      status_code: 200
      body:
        token: "{token:s}"
      headers:
        content-type: application/json
  
---

test_name: adding and taggind a device

stages:
  - name: login
    request:
      url: http://localhost:5000/api/v1/appmgr/tokenservice
      method: POST
      auth:
        - admin
        - admin_123
    response:
      status_code: 200
      headers:
        content-type: application/json
      save:
        body:
          token: token

  - name: adding device
    request:
      url: http://localhost:5000/api/v1/appmgr/devices
      method: POST
      headers:
        x-token-id: "{token:s}"
        content-type: application/json
      json:
        ipAddress: "192.192.192.192"
        port: "8888"
        username: t
        password: t
    response:
      status_code: 201
      headers:
        content-type: application/json
      save:
        body:
          deviceid: deviceId
  
  - name: creating tag
    request:
      url: http://localhost:5000/api/v1/appmgr/tags
      method: POST
      headers:
        x-token-id: "{token:s}"
        content-type: application/json
      json:
        name: "new_tag"
    response:
      status_code: 200
      headers: 
        content-type: application/json
      save:
        body:
          tagid: tagId
  
  - name: tagging device {deviceid:s}
    request:
      url: https://%s/api/v1/appmgr/tags/{tagid:d}/devices
      method: POST
      headers:
        x-token-id: "{token:s}"
        content-type: application/json
      json:
        devices: "[{deviceid:d}]"
    response:
      status_code: 200
      headers:
        content-type: application/json
      body:
        tagId: "{tagid:d}"
  
          
  
  



